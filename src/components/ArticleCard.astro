---
import { withWebpSupport } from "../utils/storyblokUtils";
import ExternalLinkIcon from "./ExternalLinkIcon.astro";
import StoryblokImage from "./StoryblokImage.astro";

interface Props {
  coverImageUrl?: string;
  coverImageAlt?: string;

  title: string;
  description?: string;

  linkHref?: string;
  linkText?: string;
  isLinkExternal?: string;
}

const { coverImageUrl, coverImageAlt, title, description, linkHref, linkText = "Read more", isLinkExternal } = Astro.props;
---

<div class="card" x-data=" { hover: false }">
  {
    coverImageUrl && (
      <div class="img-wrapper" :class="hover ? 'highlighted' : ''">
        <StoryblokImage
              url={coverImageUrl}
              alt={coverImageAlt}
              lazyload={false}
              maxWidth={600}
              fitCover={true}
            />
      </div>
    )
  }

    <div class="el">
      <h3>{title}</h3>
      {description && <p class="text-small">{description}</p>}
    </div>

    {
      linkHref && <a
            class="link"
            href={linkHref}
            @mouseover="hover = true"
            @mouseout="hover = false"
            aria-label={linkText + " about " + title}
            data-astro-prefetch
          >
            {linkText}
          </a>
      
    }
</div>

<style>
  .card {
    background-color: var(--color-neutral-200);
    grid-row: auto / span 3;

    display: grid;
    grid-template-rows: subgrid;

    margin-bottom: .5rem;

    .el {
      grid-row: 2 / 3;
      padding: 1.5rem 1rem;

      & > * + p {
        margin-top: .5rem;
      }

      & > p {
        color: var(--color-neutral-800);
      }
    }

    .link {
      grid-row: 3 / 4;
      padding: 1rem;
      margin-top: 1rem;
    }

    .img-wrapper {
      grid-row: 1 / 2;
      overflow: hidden;
      height: 14rem;
    }
</style>